<!DOCTYPE html>
<html>

<head>
    <title>Webslesson Tutorial | Search HTML Table Data by using JQuery</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" />
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="search_city.css">
    <style>
        #result {
            position: absolute;
            width: 100%;
            max-width: 870px;
            cursor: pointer;
            overflow-y: auto;
            max-height: 400px;
            box-sizing: border-box;
            z-index: 1001;
        }

        .link-class:hover {
            background-color: #f1f1f1;
        }
    </style>
</head>

<body>
    <br /><br />
    <div class="container" style="width:900px;">
        <h2 align="center">JSON Live Data Search using Ajax JQuery</h2>
        <!-- <h3 align="center">Employee Data</h3>
        <br /><br />
        <div align="center">
            <input type="text" name="city_id" id="city_id_val" value="1100031" placeholder="city_id_val"
                class="form-control" autocomplete="off" />

            <input type="text" name="search" id="search" placeholder="Search Employee Details" class="form-control"
                autocomplete="off" />
        </div>
        <ul class="list-group" id="result"></ul>
        <br /> -->

        <div class="fb-text form-group field-address[city_id]">
            <label for="address[city_id]" class="fb-text-label">address[city_id]</label>
            <input type="text" class="form-control resolver TODO FIXIT" name="address[city_id]" id="address_city_id" value="4106902"  autocomplete="off" readonly>
        
            <input type="text" id="search_city" placeholder="Informe sua cidade" class="form-control" autocomplete="off" required>
            <ul class="list-group" id="result_cities"></ul>
        </div>

        <div class="fb-text form-group field-address[city_id]">
            <label for="address[city_id]" class="fb-text-label">address[city_id]</label>
            <input type="text" class="form-control resolver TODO FIXIT" value="dsfkdhfdkhfj" id="teste">
            <ul class="list-group"></ul>
        </div>
        <input type="text" class="form-control crazy_cep" id="crazy_cep">

    </div>


<script>
    var options =  {
  onKeyPress: function(cep, e, field, options) {
    var masks = ['00000-000', '0-00-00-00'];
    var mask = (cep.length>7) ? masks[1] : masks[0];
    $('.crazy_cep').mask(mask, options);
}};

$('.crazy_cep').mask('00000-000', options);
</script>
<script>

    /* $(document).ready(function(){
     $.ajaxSetup({ cache: false });
     $('#search').keyup(function(){
      $('#result').html('');
      $('#state').val('');
      var searchField = $('#search').val();
      var expression = new RegExp(searchField, "i");
      $.getJSON('data.json', function(data) {
       $.each(data, function(key, value){
        if (value.name.search(expression) != -1 || value.location.search(expression) != -1)
        {
         $('#result').append('<li class="list-group-item link-class"><img src="'+value.image+'" height="40" width="40" class="img-thumbnail" /> '+value.name+' | <span class="text-muted">'+value.location+'</span></li>');
        }
       });
      });
     });

     $('#result').on('click', 'li', function() {
      var click_text = $(this).text().split('|');
      $('#search').val($.trim(click_text[0]));
      $("#result").html('');
     });
    }); */
</script>

<script>

    // $(document).ready(function () {

    //     var search_value = $('#city_id_val').val();
    //     if (search_value.length > 0) {
    //         console.log('Carregando cidade pelo id');
    //         $.ajaxSetup({ cache: true });
    //         $('#result').html('');
    //         $('#state').val('');
    //         var searchField = search_value;
    //         var expression = new RegExp(searchField, "i");
    //         $.getJSON('//127.0.0.1:5000/public_api/cities', function (data) {
    //             $('#result').html('');
    //             $.each(data.cities, function (key, value) {
    //                 if (value.id.toString().search(expression) != -1) {
    //                     $('#search').val(value.name);
    //                 }
    //             });
    //         });
    //     }

    //     /******************************************/

    //     $.ajaxSetup({ cache: true });
    //     $('#search').keyup(function () {
    //         var search_value = $(this).val();
    //         if (search_value.length < 4) {
    //             return false;
    //         }
    //         $('#result').html('');
    //         $('#state').val('');
    //         var searchField = $('#search').val();
    //         var expression = new RegExp(searchField, "i");
    //         $.getJSON('//127.0.0.1:5000/public_api/cities?attributes=id,name,state&name=' + $('#search').val(), function (data) {
    //             $('#result').html('');
    //             $.each(data.cities, function (key, value) {
    //                 if (value.name.toString().search(expression) != -1 || value.state.toString().search(expression) != -1 || value.id.toString().search(expression) != -1) {
    //                     $('#result').append('<li class="list-group-item link-class" city_id="' + value.id + '">' + value.name + ' | <span class="text-muted">' + value.state + '</span> | <span class="text-muted">' + value.id + '</span></li>');
    //                 }
    //             });
    //         });
    //     });

    //     $('#result').on('click', 'li', function () {
    //         var click_text = $(this).attr('city_id');
    //         console.log(click_text)
    //         $('#city_id_val').val(click_text);
    //         $("#result").html('');
    //     });
    // });
</script>

<script src="search_city.js"></script>

</body>

</html>